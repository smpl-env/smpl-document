<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>smpl.envs package &mdash; smpl latest documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="smpl.envs.helpers package" href="smpl.envs.helpers.html" />
    <link rel="prev" title="MAbEnv" href="../mabenv.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> smpl
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../reactorenv.html">ReactorEnv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atropineenv.html">AtropineEnv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pensimenv.html">PenSimEnv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beerfmtenv.html">BeerFMTEnv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mabenv.html">MAbEnv</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">smpl.envs package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="smpl.envs.helpers.html">smpl.envs.helpers package</a></li>
<li class="toctree-l3"><a class="reference internal" href="smpl.envs.models.html">smpl.envs.models package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-smpl.envs.atropineenv">smpl.envs.atropineenv module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-smpl.envs.beerfmtenv">smpl.envs.beerfmtenv module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-smpl.envs.pensimenv">smpl.envs.pensimenv module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-smpl.envs.reactorenv">smpl.envs.reactorenv module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-smpl.envs.utils">smpl.envs.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-smpl.envs">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">smpl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>smpl.envs package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/smpl.envs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="smpl-envs-package">
<h1>smpl.envs package<a class="headerlink" href="#smpl-envs-package" title="Permalink to this headline"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="smpl.envs.helpers.html">smpl.envs.helpers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="smpl.envs.helpers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="smpl.envs.helpers.html#module-smpl.envs.helpers.constants">smpl.envs.helpers.constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="smpl.envs.helpers.html#module-smpl.envs.helpers.helper_funcs">smpl.envs.helpers.helper_funcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="smpl.envs.helpers.html#module-smpl.envs.helpers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="smpl.envs.models.html">smpl.envs.models package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="smpl.envs.models.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="smpl.envs.models.html#module-smpl.envs.models.atropine_process">smpl.envs.models.atropine_process module</a></li>
<li class="toctree-l2"><a class="reference internal" href="smpl.envs.models.html#module-smpl.envs.models.config">smpl.envs.models.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="smpl.envs.models.html#module-smpl.envs.models">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-smpl.envs.atropineenv">
<span id="smpl-envs-atropineenv-module"></span><h2>smpl.envs.atropineenv module<a class="headerlink" href="#module-smpl.envs.atropineenv" title="Permalink to this headline"></a></h2>
<p>AtropineEnv simulates an atropine production environment.</p>
<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.atropineenv.</span></span><span class="sig-name descname"><span class="pre">AtropineEnvGym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dense_reward=True</span></em>, <em class="sig-param"><span class="pre">normalize=True</span></em>, <em class="sig-param"><span class="pre">debug_mode=False</span></em>, <em class="sig-param"><span class="pre">action_dim=4</span></em>, <em class="sig-param"><span class="pre">reward_function=None</span></em>, <em class="sig-param"><span class="pre">done_calculator=None</span></em>, <em class="sig-param"><span class="pre">observation_name=None</span></em>, <em class="sig-param"><span class="pre">action_name=None</span></em>, <em class="sig-param"><span class="pre">np_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em>, <em class="sig-param"><span class="pre">max_steps=60</span></em>, <em class="sig-param"><span class="pre">error_reward=-100000.0</span></em>, <em class="sig-param"><span class="pre">x0_loc='https://raw.githubusercontent.com/smpl-env/smpl/main/smpl/configdata/atropineenv/x0.txt'</span></em>, <em class="sig-param"><span class="pre">z0_loc='https://raw.githubusercontent.com/smpl-env/smpl/main/smpl/configdata/atropineenv/z0.txt'</span></em>, <em class="sig-param"><span class="pre">model_loc='https://github.com/smpl-env/smpl-experiments/blob/main/configdata/atropineenv/model.npy?raw=true'</span></em>, <em class="sig-param"><span class="pre">uss_subtracted=True</span></em>, <em class="sig-param"><span class="pre">reward_on_ess_subtracted=False</span></em>, <em class="sig-param"><span class="pre">reward_on_steady=True</span></em>, <em class="sig-param"><span class="pre">reward_on_absolute_efactor=False</span></em>, <em class="sig-param"><span class="pre">reward_on_actions_penalty=0.0</span></em>, <em class="sig-param"><span class="pre">reward_on_reject_actions=True</span></em>, <em class="sig-param"><span class="pre">reward_scaler=1.0</span></em>, <em class="sig-param"><span class="pre">relaxed_max_min_actions=False</span></em>, <em class="sig-param"><span class="pre">observation_include_t=True</span></em>, <em class="sig-param"><span class="pre">observation_include_action=False</span></em>, <em class="sig-param"><span class="pre">observation_include_uss=True</span></em>, <em class="sig-param"><span class="pre">observation_include_ess=True</span></em>, <em class="sig-param"><span class="pre">observation_include_e=True</span></em>, <em class="sig-param"><span class="pre">observation_include_kf=True</span></em>, <em class="sig-param"><span class="pre">observation_include_z=True</span></em>, <em class="sig-param"><span class="pre">observation_include_x=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#smpl.envs.utils.smplEnvBase" title="smpl.envs.utils.smplEnvBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">smpl.envs.utils.smplEnvBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym.done_calculator_standard">
<span class="sig-name descname"><span class="pre">done_calculator_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym.done_calculator_standard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym.done_calculator_standard" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>check whether the current episode is considered finished.</dt><dd><p>returns a boolean value indicated done or not, and a dictionary with information.
here in done_calculator_standard, done_info looks like {“terminal”: boolean, “timeout”: boolean},
where “timeout” is true when episode end due to reaching the maximum episode length,
“terminal” is true when “timeout” or episode end due to termination conditions such as env error encountered. (basically done)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>step_count</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em>) – step_count.</p></li>
<li><p><strong>reward</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – reward.</p></li>
<li><p><strong>done</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>done_info</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>]</em><em>, </em><em>optional</em>) – how the environment is finished. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>done and done_info.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a>)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym.evaluate_rewards_mean_std_over_episodes">
<span class="sig-name descname"><span class="pre">evaluate_rewards_mean_std_over_episodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_plt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./plt_results'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computer_on_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym.evaluate_rewards_mean_std_over_episodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym.evaluate_rewards_mean_std_over_episodes" title="Permalink to this definition"></a></dt>
<dd><p>returns: mean and std of rewards over all episodes.
since the rewards_list is not aligned (e.g. some trajectories are shorter than the others), so we cannot directly convert it to numpy array.
we have to convert and unwrap the nested list.
if computer_on_episodes, we first average the rewards_list over episodes, then compute the mean and std.
else, we directly compute the mean and std for each step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym.evalute_algorithms">
<span class="sig-name descname"><span class="pre">evalute_algorithms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_plt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./plt_results'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym.evalute_algorithms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym.evalute_algorithms" title="Permalink to this definition"></a></dt>
<dd><p>when excecuting evalute_algorithms, the self.normalize should be False.
algorithms: list of (algorithm, algorithm_name, normalize). algorithm has to have a method predict(observation) -&gt; action: np.ndarray.
num_episodes: number of episodes to run
error_reward: overwrite self.error_reward
initial_states: None, location of numpy file of initial states or a (numpy) list of initial states
to_plt: whether generates plot or not
plot_dir: None or directory to save plots
returns: list of average_rewards over each episode and num of episodes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efactor_fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym.plot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym.reset" title="Permalink to this definition"></a></dt>
<dd><p>Required by gym, this function resets the environment and returns an initial observation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym.reward_function_standard">
<span class="sig-name descname"><span class="pre">reward_function_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">previous_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym.reward_function_standard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym.reward_function_standard" title="Permalink to this definition"></a></dt>
<dd><p>the s, a, r, s, a calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>previous_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>action</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized action, as usual.</p></li>
<li><p><strong>current_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>reward</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – If reward is provided, directly return the reward.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reward.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym.sample_initial_state">
<span class="sig-name descname"><span class="pre">sample_initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym.sample_initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym.sample_initial_state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineEnvGym.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineEnvGym.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineEnvGym.step" title="Permalink to this definition"></a></dt>
<dd><p>Required by gym, his function performs one step within the environment and returns the observation, the reward, whether the episode is finished and debug information, if any.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineMPC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.atropineenv.</span></span><span class="sig-name descname"><span class="pre">AtropineMPC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'https://github.com/smpl-env/smpl-experiments/blob/main/configdata/atropineenv/model.npy?raw=true'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uss_subtracted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_on_ess_subtracted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_on_steady</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_on_absolute_efactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_on_actions_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_on_reject_actions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relaxed_max_min_actions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_include_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_include_action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_include_uss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_include_ess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_include_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_include_kf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_include_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_include_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineMPC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineMPC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.atropineenv.AtropineMPC.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/atropineenv.html#AtropineMPC.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.atropineenv.AtropineMPC.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-smpl.envs.beerfmtenv">
<span id="smpl-envs-beerfmtenv-module"></span><h2>smpl.envs.beerfmtenv module<a class="headerlink" href="#module-smpl.envs.beerfmtenv" title="Permalink to this headline"></a></h2>
<p>BeerFMT simulates the Beer Fermentation process.</p>
<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.beerfmtenv.BeerFMTEnvGym">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.beerfmtenv.</span></span><span class="sig-name descname"><span class="pre">BeerFMTEnvGym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dense_reward=True,</span> <span class="pre">normalize=True,</span> <span class="pre">debug_mode=False,</span> <span class="pre">action_dim=1,</span> <span class="pre">observation_dim=8,</span> <span class="pre">reward_function=None,</span> <span class="pre">done_calculator=None,</span> <span class="pre">max_observations=[15,</span> <span class="pre">15,</span> <span class="pre">15,</span> <span class="pre">150,</span> <span class="pre">150,</span> <span class="pre">10,</span> <span class="pre">10,</span> <span class="pre">200],</span> <span class="pre">min_observations=[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">max_actions=[16.0],</span> <span class="pre">min_actions=[9.0],</span> <span class="pre">observation_name=['X_A',</span> <span class="pre">'X_L',</span> <span class="pre">'X_D',</span> <span class="pre">'S',</span> <span class="pre">'EtOH',</span> <span class="pre">'DY',</span> <span class="pre">'EA',</span> <span class="pre">'time'],</span> <span class="pre">action_name=['temperature'],</span> <span class="pre">np_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;,</span> <span class="pre">max_steps=200,</span> <span class="pre">error_reward=-200.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/beerfmtenv.html#BeerFMTEnvGym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.beerfmtenv.BeerFMTEnvGym" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#smpl.envs.utils.smplEnvBase" title="smpl.envs.utils.smplEnvBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">smpl.envs.utils.smplEnvBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.beerfmtenv.BeerFMTEnvGym.done_calculator_standard">
<span class="sig-name descname"><span class="pre">done_calculator_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_prev_biomass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/beerfmtenv.html#BeerFMTEnvGym.done_calculator_standard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.beerfmtenv.BeerFMTEnvGym.done_calculator_standard" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>check whether the current episode is considered finished.</dt><dd><p>returns a boolean value indicated done or not, and a dictionary with information.
here in done_calculator_standard, done_info looks like {“terminal”: boolean, “timeout”: boolean},
where “timeout” is true when episode end due to reaching the maximum episode length,
“terminal” is true when “timeout” or episode end due to termination conditions such as env error encountered. (basically done)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>step_count</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em>) – step_count.</p></li>
<li><p><strong>reward</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – reward.</p></li>
<li><p><strong>done</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>done_info</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>]</em><em>, </em><em>optional</em>) – how the environment is finished. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>done and done_info.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a>)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.beerfmtenv.BeerFMTEnvGym.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/beerfmtenv.html#BeerFMTEnvGym.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.beerfmtenv.BeerFMTEnvGym.reset" title="Permalink to this definition"></a></dt>
<dd><p>required by gym.
This function resets the environment and returns an initial observation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.beerfmtenv.BeerFMTEnvGym.reward_function_standard">
<span class="sig-name descname"><span class="pre">reward_function_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">previous_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/beerfmtenv.html#BeerFMTEnvGym.reward_function_standard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.beerfmtenv.BeerFMTEnvGym.reward_function_standard" title="Permalink to this definition"></a></dt>
<dd><p>the s, a, r, s, a calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>previous_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>action</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized action, as usual.</p></li>
<li><p><strong>current_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>reward</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – If reward is provided, directly return the reward.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reward.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.beerfmtenv.BeerFMTEnvGym.sample_initial_state">
<span class="sig-name descname"><span class="pre">sample_initial_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/beerfmtenv.html#BeerFMTEnvGym.sample_initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.beerfmtenv.BeerFMTEnvGym.sample_initial_state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.beerfmtenv.BeerFMTEnvGym.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/beerfmtenv.html#BeerFMTEnvGym.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.beerfmtenv.BeerFMTEnvGym.step" title="Permalink to this definition"></a></dt>
<dd><p>required by gym.
This function performs one step within the environment and returns the observation, the reward, whether the episode is finished and debug information, if any.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="smpl.envs.beerfmtenv.beer_ode">
<span class="sig-prename descclassname"><span class="pre">smpl.envs.beerfmtenv.</span></span><span class="sig-name descname"><span class="pre">beer_ode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/beerfmtenv.html#beer_ode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.beerfmtenv.beer_ode" title="Permalink to this definition"></a></dt>
<dd><p>Beer fermentation process</p>
</dd></dl>

</section>
<section id="module-smpl.envs.pensimenv">
<span id="smpl-envs-pensimenv-module"></span><h2>smpl.envs.pensimenv module<a class="headerlink" href="#module-smpl.envs.pensimenv" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.pensimenv.PenSimEnvGym">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.pensimenv.</span></span><span class="sig-name descname"><span class="pre">PenSimEnvGym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">recipe_combo,</span> <span class="pre">dense_reward=True,</span> <span class="pre">normalize=True,</span> <span class="pre">debug_mode=False,</span> <span class="pre">action_dim=6,</span> <span class="pre">observation_dim=9,</span> <span class="pre">reward_function=None,</span> <span class="pre">done_calculator=None,</span> <span class="pre">max_observations=[552.0,</span> <span class="pre">16.10523,</span> <span class="pre">725.6828,</span> <span class="pre">13.717274,</span> <span class="pre">540.0,</span> <span class="pre">3600.0002,</span> <span class="pre">1892.07874,</span> <span class="pre">253840.11,</span> <span class="pre">47.898834],</span> <span class="pre">min_observations=[0.0,</span> <span class="pre">0.0,</span> <span class="pre">118.98977,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">25003.258,</span> <span class="pre">0.0],</span> <span class="pre">max_actions=[4100.0,</span> <span class="pre">151.0,</span> <span class="pre">36.0,</span> <span class="pre">76.0,</span> <span class="pre">1.2,</span> <span class="pre">510.0],</span> <span class="pre">min_actions=[0.0,</span> <span class="pre">7.0,</span> <span class="pre">21.0,</span> <span class="pre">29.0,</span> <span class="pre">0.5,</span> <span class="pre">0.0],</span> <span class="pre">observation_name=None,</span> <span class="pre">action_name=None,</span> <span class="pre">initial_state_deviation_ratio=0.1,</span> <span class="pre">np_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;,</span> <span class="pre">max_steps=1150,</span> <span class="pre">error_reward=-100.0,</span> <span class="pre">fast=True,</span> <span class="pre">random_seed=0,</span> <span class="pre">random_seed_max=20000</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/pensimenv.html#PenSimEnvGym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.pensimenv.PenSimEnvGym" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pensimpy.peni_env_setup.PenSimEnv</span></code>, <a class="reference internal" href="#smpl.envs.utils.smplEnvBase" title="smpl.envs.utils.smplEnvBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">smpl.envs.utils.smplEnvBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.pensimenv.PenSimEnvGym.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/pensimenv.html#PenSimEnvGym.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.pensimenv.PenSimEnvGym.reset" title="Permalink to this definition"></a></dt>
<dd><p>Setup the envs and return the observation class x.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.pensimenv.PenSimEnvGym.sample_initial_state">
<span class="sig-name descname"><span class="pre">sample_initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">random_seed_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/pensimenv.html#PenSimEnvGym.sample_initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.pensimenv.PenSimEnvGym.sample_initial_state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.pensimenv.PenSimEnvGym.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/pensimenv.html#PenSimEnvGym.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.pensimenv.PenSimEnvGym.step" title="Permalink to this definition"></a></dt>
<dd><p>Simulate the fermentation process by solving ODE.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.pensimenv.PeniControlData">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.pensimenv.</span></span><span class="sig-name descname"><span class="pre">PeniControlData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">load_just_a_file=''</span></em>, <em class="sig-param"><span class="pre">dataset_folder='examples/example_batches'</span></em>, <em class="sig-param"><span class="pre">delimiter='</span></em>, <em class="sig-param"><span class="pre">'</span></em>, <em class="sig-param"><span class="pre">observation_dim=9</span></em>, <em class="sig-param"><span class="pre">action_dim=6</span></em>, <em class="sig-param"><span class="pre">normalize=True</span></em>, <em class="sig-param"><span class="pre">np_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/pensimenv.html#PeniControlData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.pensimenv.PeniControlData" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>dataset class helper, mainly aims to mimic d4rl’s qlearning_dataset format (which returns a dictionary).
produced from PenSimPy generated csvs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.pensimenv.PeniControlData.get_dataset">
<span class="sig-name descname"><span class="pre">get_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/pensimenv.html#PeniControlData.get_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.pensimenv.PeniControlData.get_dataset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.pensimenv.PeniControlData.load_file_list_to_dict">
<span class="sig-name descname"><span class="pre">load_file_list_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/pensimenv.html#PeniControlData.load_file_list_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.pensimenv.PeniControlData.load_file_list_to_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="smpl.envs.pensimenv.get_observation_data_reformed">
<span class="sig-prename descclassname"><span class="pre">smpl.envs.pensimenv.</span></span><span class="sig-name descname"><span class="pre">get_observation_data_reformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/pensimenv.html#get_observation_data_reformed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.pensimenv.get_observation_data_reformed" title="Permalink to this definition"></a></dt>
<dd><p>Get observation data at t.
vars are Temperature,Acid flow rate,Base flow rate,Cooling water,Heating water,Vessel Weight,Dissolved oxygen concentration
respectively in csv terms, but used abbreviation here to stay consistent with peni_env_setup</p>
</dd></dl>

</section>
<section id="module-smpl.envs.reactorenv">
<span id="smpl-envs-reactorenv-module"></span><h2>smpl.envs.reactorenv module<a class="headerlink" href="#module-smpl.envs.reactorenv" title="Permalink to this headline"></a></h2>
<p>ReactorEnv simulates a general reactor environment. This is supposed to be an template environment. The documentations in that file is enhanced and provided comment lines (# —- standard —- and # /—- standard —-) enclose pieces of code that should be reused by most of smpl environments. Please consult the smplEnvBase class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.reactorenv.</span></span><span class="sig-name descname"><span class="pre">ReactorEnvGym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dense_reward=True,</span> <span class="pre">normalize=True,</span> <span class="pre">debug_mode=False,</span> <span class="pre">action_dim=2,</span> <span class="pre">observation_dim=3,</span> <span class="pre">reward_function=None,</span> <span class="pre">done_calculator=None,</span> <span class="pre">max_observations=[1.0,</span> <span class="pre">100.0,</span> <span class="pre">1.0],</span> <span class="pre">min_observations=[1e-08,</span> <span class="pre">1e-08,</span> <span class="pre">1e-08],</span> <span class="pre">max_actions=[35.0,</span> <span class="pre">0.2],</span> <span class="pre">min_actions=[15.0,</span> <span class="pre">0.05],</span> <span class="pre">error_reward=-1000.0,</span> <span class="pre">initial_state_deviation_ratio=0.3,</span> <span class="pre">compute_diffs_on_reward=False,</span> <span class="pre">np_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;,</span> <span class="pre">sampling_time=0.1,</span> <span class="pre">max_steps=100</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#smpl.envs.utils.smplEnvBase" title="smpl.envs.utils.smplEnvBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">smpl.envs.utils.smplEnvBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.evaluate_observation">
<span class="sig-name descname"><span class="pre">evaluate_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.evaluate_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.evaluate_observation" title="Permalink to this definition"></a></dt>
<dd><p>observation: numpy array of shape (self.observation_dim)
returns: observation evaluation (reward in a sense)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.evaluate_rewards_mean_std_over_episodes">
<span class="sig-name descname"><span class="pre">evaluate_rewards_mean_std_over_episodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_plt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./plt_results'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computer_on_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.evaluate_rewards_mean_std_over_episodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.evaluate_rewards_mean_std_over_episodes" title="Permalink to this definition"></a></dt>
<dd><p>returns: mean and std of rewards over all episodes.
since the rewards_list is not aligned (e.g. some trajectories are shorter than the others), so we cannot directly convert it to numpy array.
we have to convert and unwrap the nested list.
if computer_on_episodes, we first average the rewards_list over episodes, then compute the mean and std.
else, we directly compute the mean and std for each step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.evalute_algorithms">
<span class="sig-name descname"><span class="pre">evalute_algorithms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_plt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./plt_results'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.evalute_algorithms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.evalute_algorithms" title="Permalink to this definition"></a></dt>
<dd><p>when excecuting evalute_algorithms, the self.normalize should be False.
algorithms: list of (algorithm, algorithm_name, normalize). algorithm has to have a method predict(observation) -&gt; action: np.ndarray.
num_episodes: number of episodes to run
error_reward: overwrite self.error_reward
initial_states: None, location of numpy file of initial states or a (numpy) list of initial states
to_plt: whether generates plot or not
plot_dir: None or directory to save plots
returns: list of average_rewards over each episode and num of episodes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.evenly_spread_initial_states">
<span class="sig-name descname"><span class="pre">evenly_spread_initial_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val_per_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.evenly_spread_initial_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.evenly_spread_initial_states" title="Permalink to this definition"></a></dt>
<dd><p>Evenly spread initial states.
This function is needed only if the environment has steady_observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val_per_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – how many values to sampler per state.</p>
</dd>
</dl>
<p>Returns:
[initial_states]: evenly spread initial_states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.find_outperformances">
<span class="sig-name descname"><span class="pre">find_outperformances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.find_outperformances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.find_outperformances" title="Permalink to this definition"></a></dt>
<dd><p>this function computes the outperformances of the last algorithm in algorithms.
there are three criteria:
if in a trajectory, the algorithm has reward &gt;= all other algorithms, the corresponding initial_state is stored to always_better.
if in a trajectory, the algorithm’s mean reward &gt;= threshold + all other algorithms’ mean reward, the corresponding initial_state is stored to averagely_better.
for the top_k most outperformed reward mean, the corresponding initial_state is stored to top_k_better, in ascending order.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.find_outperformances_compute_always_better">
<span class="sig-name descname"><span class="pre">find_outperformances_compute_always_better</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.find_outperformances_compute_always_better"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.find_outperformances_compute_always_better" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.find_outperformances_compute_average_outperformances">
<span class="sig-name descname"><span class="pre">find_outperformances_compute_average_outperformances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.find_outperformances_compute_average_outperformances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.find_outperformances_compute_average_outperformances" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.generate_dataset_with_algorithm">
<span class="sig-name descname"><span class="pre">generate_dataset_with_algorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'d4rl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.generate_dataset_with_algorithm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.generate_dataset_with_algorithm" title="Permalink to this definition"></a></dt>
<dd><p>this function aims to create a dataset for offline reinforcement learning, in either d4rl or pytorch format.
the trajectories are generated by the algorithm, which interacts with this env initialized by initial_states.
algorithm: an instance that has a method predict(observation) -&gt; action: np.ndarray.
if format == ‘d4rl’, returns a dictionary in d4rl format.
else if format == ‘torch’, returns an object of type torch.utils.data.Dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.reset" title="Permalink to this definition"></a></dt>
<dd><p>required by gym.
This function resets the environment and returns an initial observation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.reward_function_standard">
<span class="sig-name descname"><span class="pre">reward_function_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">previous_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.reward_function_standard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.reward_function_standard" title="Permalink to this definition"></a></dt>
<dd><p>the s, a, r, s, a calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>previous_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>action</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized action, as usual.</p></li>
<li><p><strong>current_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>reward</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – If reward is provided, directly return the reward.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reward.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.sample_initial_state">
<span class="sig-name descname"><span class="pre">sample_initial_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.sample_initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.sample_initial_state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorEnvGym.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorEnvGym.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorEnvGym.step" title="Permalink to this definition"></a></dt>
<dd><p>required by gym.
This function performs one step within the environment and returns the observation, the reward, whether the episode is finished and debug information, if any.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorMLPReinforceAgent">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.reactorenv.</span></span><span class="sig-name descname"><span class="pre">ReactorMLPReinforceAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorMLPReinforceAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorMLPReinforceAgent" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>a simple torch-MLP based rl agent,.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Can either return a sampled action or the distribution the action sampled from.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.10)">type</a>]</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorMLPReinforceAgent.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorMLPReinforceAgent.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorMLPReinforceAgent.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorMLPReinforceAgent.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#smpl.envs.reactorenv.ReactorMLPReinforceAgent.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorMPC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.reactorenv.</span></span><span class="sig-name descname"><span class="pre">ReactorMPC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.1,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.1,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.1]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.1,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.1,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.1]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorMPC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorMPC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>a simple MPC controller.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>action.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.10)">type</a>]</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorMPC.Pffunc">
<span class="sig-name descname"><span class="pre">Pffunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorMPC.Pffunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorMPC.Pffunc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorMPC.build_controller">
<span class="sig-name descname"><span class="pre">build_controller</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorMPC.build_controller"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorMPC.build_controller" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorMPC.lfunc">
<span class="sig-name descname"><span class="pre">lfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorMPC.lfunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorMPC.lfunc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorMPC.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorMPC.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorMPC.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.reactorenv.</span></span><span class="sig-name descname"><span class="pre">ReactorModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling_time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorModel.ode">
<span class="sig-name descname"><span class="pre">ode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorModel.ode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorModel.ode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorModel.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorModel.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorModel.step" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorPID">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.reactorenv.</span></span><span class="sig-name descname"><span class="pre">ReactorPID</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Kis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steady_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.8778252,</span> <span class="pre">0.659]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steady_action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[26.85,</span> <span class="pre">0.1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[15.0,</span> <span class="pre">0.05]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[35.0,</span> <span class="pre">0.2]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorPID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorPID" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>a simple proportional controller that utilizes the config of this environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>action.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.10)">type</a>]</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.reactorenv.ReactorPID.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/reactorenv.html#ReactorPID.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.reactorenv.ReactorPID.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-smpl.envs.utils">
<span id="smpl-envs-utils-module"></span><h2>smpl.envs.utils module<a class="headerlink" href="#module-smpl.envs.utils" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.utils.TorchDatasetFromD4RL">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.utils.</span></span><span class="sig-name descname"><span class="pre">TorchDatasetFromD4RL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_d4rl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#TorchDatasetFromD4RL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.TorchDatasetFromD4RL" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.dataset.T_co</span></code>]</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">smpl.envs.utils.</span></span><span class="sig-name descname"><span class="pre">smplEnvBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dense_reward=True,</span> <span class="pre">normalize=True,</span> <span class="pre">debug_mode=False,</span> <span class="pre">action_dim=2,</span> <span class="pre">observation_dim=3,</span> <span class="pre">max_observations=[1.0,</span> <span class="pre">1.0],</span> <span class="pre">min_observations=[-1.0,</span> <span class="pre">-1.0],</span> <span class="pre">max_actions=[1.0,</span> <span class="pre">1.0],</span> <span class="pre">min_actions=[-1.0,</span> <span class="pre">-1.0],</span> <span class="pre">observation_name=None,</span> <span class="pre">action_name=None,</span> <span class="pre">initial_state_deviation_ratio=None,</span> <span class="pre">np_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;,</span> <span class="pre">max_steps=None,</span> <span class="pre">error_reward=-100.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.core.Env</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.action_beyond_box">
<span class="sig-name descname"><span class="pre">action_beyond_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.action_beyond_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.action_beyond_box" title="Permalink to this definition"></a></dt>
<dd><p>check if the action is beyond the box, which is what we don’t want.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized action, as usual.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action is beyond the box or not.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.algorithms_to_algo_names">
<span class="sig-name descname"><span class="pre">algorithms_to_algo_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.algorithms_to_algo_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.algorithms_to_algo_names" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>algorithms</strong> – list of (algorithm, algorithm_name, normalize).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of algorithm_name.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.dataset_to_observations_actions_rewards_list">
<span class="sig-name descname"><span class="pre">dataset_to_observations_actions_rewards_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.dataset_to_observations_actions_rewards_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.dataset_to_observations_actions_rewards_list" title="Permalink to this definition"></a></dt>
<dd><p>_summary_</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>_type_</em>) – d4rl or torch format dataset obtained from generate_dataset_with_algorithm</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the same as evalute_algorithms</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.done_calculator_standard">
<span class="sig-name descname"><span class="pre">done_calculator_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.done_calculator_standard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.done_calculator_standard" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>check whether the current episode is considered finished.</dt><dd><p>returns a boolean value indicated done or not, and a dictionary with information.
here in done_calculator_standard, done_info looks like {“terminal”: boolean, “timeout”: boolean},
where “timeout” is true when episode end due to reaching the maximum episode length,
“terminal” is true when “timeout” or episode end due to termination conditions such as env error encountered. (basically done)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>step_count</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em>) – step_count.</p></li>
<li><p><strong>reward</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – reward.</p></li>
<li><p><strong>done</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>done_info</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>]</em><em>, </em><em>optional</em>) – how the environment is finished. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>done and done_info.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a>)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.evalute_algorithms">
<span class="sig-name descname"><span class="pre">evalute_algorithms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_plt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./plt_results'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.evalute_algorithms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.evalute_algorithms" title="Permalink to this definition"></a></dt>
<dd><p>when excecuting evalute_algorithms, the self.normalize should be False.
algorithms: list of (algorithm, algorithm_name, normalize). algorithm has to have a method predict(observation) -&gt; action: np.ndarray.
num_episodes: number of episodes to run
error_reward: overwrite self.error_reward
initial_states: None, location of numpy file of initial states or a (numpy) list of initial states
to_plt: whether generates plot or not
plot_dir: None or directory to save plots
returns: observations_list, actions_list, rewards_list</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.evenly_spread_initial_states">
<span class="sig-name descname"><span class="pre">evenly_spread_initial_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val_per_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.evenly_spread_initial_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.evenly_spread_initial_states" title="Permalink to this definition"></a></dt>
<dd><p>Evenly spread initial states.
This function is needed only if the environment has steady_observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val_per_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – how many values to sampler per state.</p>
</dd>
</dl>
<p>Returns:
[initial_states]: evenly spread initial_states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.generate_dataset_with_algorithm">
<span class="sig-name descname"><span class="pre">generate_dataset_with_algorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'d4rl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.generate_dataset_with_algorithm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.generate_dataset_with_algorithm" title="Permalink to this definition"></a></dt>
<dd><p>this function aims to create a dataset for offline reinforcement learning, in either d4rl or pytorch format.
the trajectories are generated by the algorithm, which interacts with this env initialized by initial_states.
algorithm: an instance that has a method predict(observation) -&gt; action: np.ndarray.
if format == ‘d4rl’, returns a dictionary in d4rl format.
else if format == ‘torch’, returns an object of type torch.utils.data.Dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.observation_beyond_box">
<span class="sig-name descname"><span class="pre">observation_beyond_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.observation_beyond_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.observation_beyond_box" title="Permalink to this definition"></a></dt>
<dd><p>check if the observation is beyond the box, which is what we don’t want.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>observation is beyond the box or not.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.observation_done_and_reward_calculator">
<span class="sig-name descname"><span class="pre">observation_done_and_reward_calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.observation_done_and_reward_calculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.observation_done_and_reward_calculator" title="Permalink to this definition"></a></dt>
<dd><p>the s, a, r, s, a rollout, with error checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_observation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><em>np.ndarray</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>previous_observation</strong> (<em>np.ndarray</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>action</strong> (<em>np.ndarray</em>) – This is denormalized action, as usual.</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Defaults to None.</p></li>
<li><p><strong>step_reward</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – The reward of current step. Defaults to None.</p></li>
<li><p><strong>done_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>, </em><em>optional</em>) – Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>This is the returned observation controlled by the normalize argument, for step function.
[(float, bool, dict)]: reward, done and done_info.
done_info looks like {“timeout”: boolean, “error_occurred”: boolean, “terminal”: boolean},
where “timeout” is true when episode end due to reaching the maximum episode length,
“error_occurred”: is true when episode end due to env error encountered,
“terminal” is true when “timeout” or episode end due to termination conditions such as product collection is finished. (basically done).
“terminal” should be True whenever timeout or error_occurred.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>observation (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.report_rewards">
<span class="sig-name descname"><span class="pre">report_rewards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.report_rewards"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.report_rewards" title="Permalink to this definition"></a></dt>
<dd><p>returns: mean and std of rewards over all episodes.
since the rewards_list is not aligned (e.g. some trajectories are shorter than the others), so we cannot directly convert it to numpy array.
we have to convert and unwrap the nested list.
on_episodes first average the rewards_list over episodes, then compute the mean and std.
all_rewards directly compute the mean and std for each step.
# rewards_list[i][j][t] is algorithm_i_game_j_reward_t.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.reset" title="Permalink to this definition"></a></dt>
<dd><p>Required by gym, this function resets the environment and returns an initial observation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.reward_function_standard">
<span class="sig-name descname"><span class="pre">reward_function_standard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">previous_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.reward_function_standard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.reward_function_standard" title="Permalink to this definition"></a></dt>
<dd><p>the s, a, r, s, a calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>previous_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>action</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized action, as usual.</p></li>
<li><p><strong>current_observation</strong> (<em>[</em><em>np.ndarray</em><em>]</em>) – This is denormalized observation, as usual.</p></li>
<li><p><strong>reward</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em>) – If reward is provided, directly return the reward.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reward.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.sample_initial_state">
<span class="sig-name descname"><span class="pre">sample_initial_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.sample_initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.sample_initial_state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.set_initial_states">
<span class="sig-name descname"><span class="pre">set_initial_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.set_initial_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.set_initial_states" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smpl.envs.utils.smplEnvBase.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/smpl/envs/utils.html#smplEnvBase.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smpl.envs.utils.smplEnvBase.step" title="Permalink to this definition"></a></dt>
<dd><p>Required by gym, his function performs one step within the environment and returns the observation, the reward, whether the episode is finished and debug information, if any.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-smpl.envs">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-smpl.envs" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../mabenv.html" class="btn btn-neutral float-left" title="MAbEnv" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="smpl.envs.helpers.html" class="btn btn-neutral float-right" title="smpl.envs.helpers package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SMPL Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>